# 🎵 提示词优化说明

## 优化日期：2025-11-04

根据 MiniMax Music API 的最佳实践，我们对音乐和歌词生成提示词进行了全面优化。

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

## 📋 API 参数要求

### Music Prompt（音乐描述）
- **用途**：指定风格、情绪和场景
- **格式示例**："流行音乐, 难过, 适合在下雨的晚上"
- **长度限制**：10-2000 个字符
- **语言**：中文
- **要求**：描述具体、情感丰富、场景感强

### Lyrics（歌词）
- **格式**：使用 \n 分隔每行
- **结构标签**：[Intro], [Verse], [Chorus], [Bridge], [Outro]
- **长度限制**：10-3000 个字符
- **要求**：完整歌曲结构，有诗意和情感深度

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

## 🔄 优化对比

### 优化前：

**System Prompt:**
```
你是一个音乐创作专家，擅长根据用户的心情设计音乐风格和歌词。
```

**User Prompt:**
```
请为这个心情创作：
1. 音乐风格描述（用英文，包括风格、节奏、情感等，限50字以内）
2. 歌词（中文，4-8句，简短精炼，适合发朋友圈，要有诗意）
```

**问题：**
- ❌ 音乐描述用英文（API 更适合中文）
- ❌ 音乐描述太短（50字）
- ❌ 歌词太短（4-8句）
- ❌ 没有歌曲结构标签
- ❌ 没有场景描述

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

### 优化后：

**System Prompt:**
```
你是一个专业的音乐制作人和词曲创作者，精通各种音乐风格，擅长将情感转化为音乐和歌词。
```

**User Prompt:**
```
1. **音乐描述 (prompt)**：
   - 用中文描述，包含：音乐风格、情绪、适合的场景
   - 格式示例："流行音乐, 温暖舒适, 适合在阳光明媚的午后"
   - 要求：描述具体、情感丰富、场景感强
   - 长度：50-200字

2. **歌词 (lyrics)**：
   - 使用中文创作完整歌曲结构
   - 必须包含结构标签：[Intro], [Verse], [Chorus], [Bridge], [Outro]
   - 每个部分要有诗意和情感深度
   - 适合发朋友圈分享
   - 使用换行符分隔每行歌词
   - 长度：100-500字
```

**改进：**
- ✅ 音乐描述改为中文
- ✅ 音乐描述长度增加到 50-200 字
- ✅ 包含风格、情绪、场景三要素
- ✅ 歌词增加完整结构标签
- ✅ 歌词长度增加到 100-500 字
- ✅ 更专业的角色定位
- ✅ max_tokens 从 2048 增加到 4096

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

## 📝 期望输出示例

### 输入心情：
```
今天很开心，阳光明媚，充满活力
```

### 优化前输出：
```json
{
  "prompt": "Upbeat pop music with cheerful melody",
  "lyrics": "阳光洒满心房\n快乐在空中飘荡\n每一刻都闪着光\n幸福就是这模样"
}
```

### 优化后输出：
```json
{
  "prompt": "流行音乐, 欢快明亮, 充满活力, 适合在阳光明媚的早晨或户外活动时播放, 节奏轻快, 旋律优美, 给人温暖和希望的感觉",
  "lyrics": "[Intro]\n阳光洒满每个角落\n心情像风一样自由\n\n[Verse]\n今天的天空特别蓝\n笑容在脸上绽放\n每一步都充满力量\n世界因我而闪亮\n\n[Chorus]\n快乐飞扬 随风荡漾\n这一刻我最闪耀\n心跳加速 拥抱希望\n生活如此美好\n\n[Bridge]\n让阳光住进心房\n让温暖永不消散\n\n[Outro]\n今天的我 最闪亮\n快乐时光 永难忘"
}
```

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

## 🎯 优化效果

### 音乐质量提升：
1. **更精准的风格定位**：中文描述更符合 API 要求
2. **更丰富的场景感**：明确指定适合的场景和氛围
3. **更细腻的情感表达**：包含情绪、节奏、旋律等多维度描述

### 歌词质量提升：
1. **完整的歌曲结构**：有开场、主歌、副歌、桥段、尾声
2. **更好的韵律感**：要求押韵和节奏感
3. **更长的内容**：100-500字，更完整的表达
4. **专业的音乐制作**：使用行业标准结构标签

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

## 📊 技术细节

### 代码位置
- 文件：`main.py`
- 函数：`generate_music_prompt_with_llm()`
- 行数：34-68

### 主要修改：
1. System Prompt：更专业的角色定位
2. User Prompt：详细的创作要求
3. max_tokens：2048 → 4096
4. 输出格式：添加结构标签示例

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

## 🚀 使用说明

优化后的提示词会自动生效，用户无需任何操作：

1. 访问 http://localhost:5111
2. 输入 API Key 和心情
3. 生成音乐
4. 获得更高质量、更完整的音乐和歌词！

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

## 📈 预期改进

- ✅ 音乐风格更准确
- ✅ 情感表达更丰富
- ✅ 场景描述更具体
- ✅ 歌词结构更完整
- ✅ 韵律节奏更优美
- ✅ 整体质量大幅提升

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

**版本：** v1.3.0  
**优化时间：** 2025-11-04  
**状态：** ✅ 已部署并运行
